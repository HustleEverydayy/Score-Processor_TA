# Score-Processor_TA
微積分TA小code

# 成績處理程式 (Score Processor)

## 簡介
這是一個用於處理課程考試成績的 Python 程式。它可以將 Excel 格式的考試回答轉換為 CSV，計算學生成績，並更新到成績總表中。本程式特別適用於需要依據作答時間計算權重分數的情況。

## 功能特點
- Excel 檔案轉換為 CSV 格式
- 自動辨識題目數量
- 依據作答時間計算權重分數
- 自動更新成績總表
- 使用者友善的圖形介面

## 系統需求
- Python 3.8 或更新版本
- 需要安裝以下 Python 套件：
  ```bash
  pip install pandas numpy openpyxl
  ```

## 安裝方式
1. 下載程式檔案 `score_processor.py`
2. 安裝必要的套件：
   ```bash
   pip install pandas numpy openpyxl
   ```

## 使用說明
1. 執行程式：
   ```bash
   python score_processor.py
   ```

2. 程式執行步驟：
   1. **選擇 Excel 檔案**
      - 選擇包含學生答案的 Excel 檔案
      - 檔案格式要求：
        * 必須包含「時間戳記」欄位
        * 必須包含「學號」欄位
        * 題目欄位必須包含「題」字
   
   2. **設定時間單位**
      - 輸入計算成績權重的時間單位（分鐘）
      - 例如：輸入 5 表示每 5 分鐘為一個時間單位
   
   3. **選擇成績總表**
      - 選擇要更新的成績總表 CSV 檔案
   
   4. **輸入日期**
      - 輸入要更新的日期欄位名稱
      - 格式範例：「10月8號」

## 輸入檔案格式要求

### 1. 學生答案 Excel 檔案格式
| 時間戳記 | 學號 | 1題 | 2題 | ... |
|---------|------|-----|-----|-----|
| [時間]   | email| [答案]| [答案]| ... |
| [時間]   | [學號]| [答案]| [答案]| ... |

### 2. 成績總表 CSV 格式
| 學號 | ... | 10月8號 | 答對題數 | ... |
|------|-----|---------|----------|-----|
| [學號]| ... | [分數]  | [題數]   | ... |

## 成績計算方式
- 基本分數 = 答對題數
- 時間權重 = 1.01 - (時間單位數 × 0.01)
- 最終分數 = 基本分數 × 時間權重

## 注意事項
1. Excel 檔案中必須包含標準答案（學號為 'email' 的那一列）
2. 時間戳記格式必須統一
3. 成績總表中的日期欄位名稱必須完全匹配
4. 建議在使用前先備份重要檔案

## 錯誤處理
如果遇到以下錯誤訊息，請參考處理方式：

1. "找不到標準答案行"
   - 檢查 Excel 檔案中是否有學號為 'email' 的列

2. "找不到題目欄位"
   - 檢查題目欄位名稱是否包含「題」字

3. "無法解析時間"
   - 檢查時間戳記格式是否正確

## 更新紀錄
- v1.0.0 (2024/12/04)
  * 整合 Excel 轉換、成績計算、成績更新功能
  * 新增使用者介面
  * 改進錯誤處理機制
